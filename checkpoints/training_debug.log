[2025-11-16 21:52:05] DEBUG - 
Initial learning rate: 1.000000e-05
[2025-11-16 21:52:05] DEBUG - Optimizer: AdamW
[2025-11-16 21:52:05] DEBUG - Scheduler: CosineAnnealingLR
[2025-11-16 21:52:08] DEBUG - 
======================================================================
[2025-11-16 21:52:08] DEBUG - BATCH 0 - Type: detection
[2025-11-16 21:52:08] DEBUG - ======================================================================
[2025-11-16 21:52:08] DEBUG - 
Batch Contents:
[2025-11-16 21:52:08] DEBUG -   query_images:
[2025-11-16 21:52:08] DEBUG -     Shape: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:08] DEBUG -     Dtype: torch.float32
[2025-11-16 21:52:08] DEBUG -     Device: cuda:0
[2025-11-16 21:52:08] DEBUG -     Range: [-2.1179, 2.6400]
[2025-11-16 21:52:08] DEBUG -     Mean: -0.5034
[2025-11-16 21:52:08] DEBUG -     Std: 0.9666
[2025-11-16 21:52:08] DEBUG -     Has NaN: False
[2025-11-16 21:52:08] DEBUG -     Has Inf: False
[2025-11-16 21:52:08] DEBUG -   support_images:
[2025-11-16 21:52:08] DEBUG -     Shape: torch.Size([2, 3, 3, 512, 512])
[2025-11-16 21:52:08] DEBUG -     Dtype: torch.float32
[2025-11-16 21:52:08] DEBUG -     Device: cuda:0
[2025-11-16 21:52:08] DEBUG -     Range: [-2.1179, 2.6400]
[2025-11-16 21:52:08] DEBUG -     Mean: 0.3177
[2025-11-16 21:52:08] DEBUG -     Std: 1.0175
[2025-11-16 21:52:08] DEBUG -     Has NaN: False
[2025-11-16 21:52:08] DEBUG -     Has Inf: False
[2025-11-16 21:52:08] DEBUG -   target_bboxes: List of 8 tensors
[2025-11-16 21:52:08] DEBUG -     First tensor shape: torch.Size([1, 4])
[2025-11-16 21:52:08] DEBUG -   target_classes: List of 8 tensors
[2025-11-16 21:52:08] DEBUG -     First tensor shape: torch.Size([1])
[2025-11-16 21:52:08] DEBUG -   class_ids:
[2025-11-16 21:52:08] DEBUG -     Shape: torch.Size([8])
[2025-11-16 21:52:08] DEBUG -     Dtype: torch.int64
[2025-11-16 21:52:08] DEBUG -     Device: cuda:0
[2025-11-16 21:52:08] DEBUG -   video_ids: List of 8 str
[2025-11-16 21:52:08] DEBUG -   num_classes: int
[2025-11-16 21:52:08] DEBUG -   batch_type: str
[2025-11-16 21:52:08] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:08] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:08] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:11] DEBUG - 
Model Outputs:
[2025-11-16 21:52:11] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:11] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:11] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2512, 1.7871]
[2025-11-16 21:52:11] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0248, 0.3237]
[2025-11-16 21:52:11] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:11] DEBUG -   pred_bboxes: torch.Size([273, 4])
[2025-11-16 21:52:11] DEBUG -   pred_cls_logits: torch.Size([273, 2])
[2025-11-16 21:52:11] DEBUG -   target_bboxes: torch.Size([273, 4])
[2025-11-16 21:52:11] DEBUG -   target_cls: torch.Size([273, 2])
[2025-11-16 21:52:11] DEBUG -   proposal_features: torch.Size([273, 512])
[2025-11-16 21:52:11] DEBUG -   proposal_labels: torch.Size([273])
[2025-11-16 21:52:11] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:11] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:11] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:11] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:11] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:12] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:12] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:12] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:13] DEBUG - 
Model Outputs:
[2025-11-16 21:52:13] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:13] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:14] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2544, 1.7881]
[2025-11-16 21:52:14] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0246, 0.3635]
[2025-11-16 21:52:14] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:14] DEBUG -   pred_bboxes: torch.Size([427, 4])
[2025-11-16 21:52:14] DEBUG -   pred_cls_logits: torch.Size([427, 2])
[2025-11-16 21:52:14] DEBUG -   target_bboxes: torch.Size([427, 4])
[2025-11-16 21:52:14] DEBUG -   target_cls: torch.Size([427, 2])
[2025-11-16 21:52:14] DEBUG -   proposal_features: torch.Size([427, 512])
[2025-11-16 21:52:14] DEBUG -   proposal_labels: torch.Size([427])
[2025-11-16 21:52:14] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:14] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:14] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:14] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:14] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:14] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:14] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:14] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:15] DEBUG - 
Model Outputs:
[2025-11-16 21:52:15] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:15] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:16] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2537, 1.7461]
[2025-11-16 21:52:16] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0241, 0.3504]
[2025-11-16 21:52:16] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:16] DEBUG -   pred_bboxes: torch.Size([151, 4])
[2025-11-16 21:52:16] DEBUG -   pred_cls_logits: torch.Size([151, 2])
[2025-11-16 21:52:16] DEBUG -   target_bboxes: torch.Size([151, 4])
[2025-11-16 21:52:16] DEBUG -   target_cls: torch.Size([151, 2])
[2025-11-16 21:52:16] DEBUG -   proposal_features: torch.Size([151, 512])
[2025-11-16 21:52:16] DEBUG -   proposal_labels: torch.Size([151])
[2025-11-16 21:52:16] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:16] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:16] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:16] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:16] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:16] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:16] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:16] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:17] DEBUG - 
Model Outputs:
[2025-11-16 21:52:17] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:17] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:18] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2573, 1.7627]
[2025-11-16 21:52:18] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0246, 0.3514]
[2025-11-16 21:52:18] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:18] DEBUG -   pred_bboxes: torch.Size([388, 4])
[2025-11-16 21:52:18] DEBUG -   pred_cls_logits: torch.Size([388, 2])
[2025-11-16 21:52:18] DEBUG -   target_bboxes: torch.Size([388, 4])
[2025-11-16 21:52:18] DEBUG -   target_cls: torch.Size([388, 2])
[2025-11-16 21:52:18] DEBUG -   proposal_features: torch.Size([388, 512])
[2025-11-16 21:52:18] DEBUG -   proposal_labels: torch.Size([388])
[2025-11-16 21:52:18] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:18] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:18] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:18] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:18] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:18] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:18] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:18] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:19] DEBUG - 
Model Outputs:
[2025-11-16 21:52:19] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:19] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:20] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2491, 1.7666]
[2025-11-16 21:52:20] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0250, 0.2757]
[2025-11-16 21:52:20] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:20] DEBUG -   pred_bboxes: torch.Size([565, 4])
[2025-11-16 21:52:20] DEBUG -   pred_cls_logits: torch.Size([565, 2])
[2025-11-16 21:52:20] DEBUG -   target_bboxes: torch.Size([565, 4])
[2025-11-16 21:52:20] DEBUG -   target_cls: torch.Size([565, 2])
[2025-11-16 21:52:20] DEBUG -   proposal_features: torch.Size([565, 512])
[2025-11-16 21:52:20] DEBUG -   proposal_labels: torch.Size([565])
[2025-11-16 21:52:20] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:20] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:20] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:20] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:20] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:20] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:20] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:20] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:22] DEBUG - 
Model Outputs:
[2025-11-16 21:52:22] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:22] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:22] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2478, 1.7646]
[2025-11-16 21:52:22] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0247, 0.2991]
[2025-11-16 21:52:22] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:22] DEBUG -   pred_bboxes: torch.Size([466, 4])
[2025-11-16 21:52:22] DEBUG -   pred_cls_logits: torch.Size([466, 2])
[2025-11-16 21:52:22] DEBUG -   target_bboxes: torch.Size([466, 4])
[2025-11-16 21:52:22] DEBUG -   target_cls: torch.Size([466, 2])
[2025-11-16 21:52:22] DEBUG -   proposal_features: torch.Size([466, 512])
[2025-11-16 21:52:22] DEBUG -   proposal_labels: torch.Size([466])
[2025-11-16 21:52:22] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:22] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:22] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:22] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:22] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:22] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:22] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:22] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:23] DEBUG - 
Model Outputs:
[2025-11-16 21:52:23] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:23] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:24] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2593, 1.7529]
[2025-11-16 21:52:24] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0247, 0.2777]
[2025-11-16 21:52:24] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:24] DEBUG -   pred_bboxes: torch.Size([583, 4])
[2025-11-16 21:52:24] DEBUG -   pred_cls_logits: torch.Size([583, 2])
[2025-11-16 21:52:24] DEBUG -   target_bboxes: torch.Size([583, 4])
[2025-11-16 21:52:24] DEBUG -   target_cls: torch.Size([583, 2])
[2025-11-16 21:52:24] DEBUG -   proposal_features: torch.Size([583, 512])
[2025-11-16 21:52:24] DEBUG -   proposal_labels: torch.Size([583])
[2025-11-16 21:52:24] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:24] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:24] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:24] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:24] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:24] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:24] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:24] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:26] DEBUG - 
Model Outputs:
[2025-11-16 21:52:26] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:26] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:26] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2500, 1.8467]
[2025-11-16 21:52:26] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0247, 0.3370]
[2025-11-16 21:52:26] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:26] DEBUG -   pred_bboxes: torch.Size([619, 4])
[2025-11-16 21:52:26] DEBUG -   pred_cls_logits: torch.Size([619, 2])
[2025-11-16 21:52:26] DEBUG -   target_bboxes: torch.Size([619, 4])
[2025-11-16 21:52:26] DEBUG -   target_cls: torch.Size([619, 2])
[2025-11-16 21:52:26] DEBUG -   proposal_features: torch.Size([619, 512])
[2025-11-16 21:52:26] DEBUG -   proposal_labels: torch.Size([619])
[2025-11-16 21:52:26] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:26] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:26] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:26] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:26] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:27] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:27] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:27] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:29] DEBUG - 
Model Outputs:
[2025-11-16 21:52:29] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:29] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:29] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2474, 1.8184]
[2025-11-16 21:52:29] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0237, 0.3565]
[2025-11-16 21:52:30] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:30] DEBUG -   pred_bboxes: torch.Size([456, 4])
[2025-11-16 21:52:30] DEBUG -   pred_cls_logits: torch.Size([456, 2])
[2025-11-16 21:52:30] DEBUG -   target_bboxes: torch.Size([456, 4])
[2025-11-16 21:52:30] DEBUG -   target_cls: torch.Size([456, 2])
[2025-11-16 21:52:30] DEBUG -   proposal_features: torch.Size([456, 512])
[2025-11-16 21:52:30] DEBUG -   proposal_labels: torch.Size([456])
[2025-11-16 21:52:30] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:30] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:30] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:30] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:30] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:30] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:30] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:30] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:31] DEBUG - 
Model Outputs:
[2025-11-16 21:52:31] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:31] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:31] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2581, 1.7461]
[2025-11-16 21:52:31] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0237, 0.3540]
[2025-11-16 21:52:32] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:32] DEBUG -   pred_bboxes: torch.Size([148, 4])
[2025-11-16 21:52:32] DEBUG -   pred_cls_logits: torch.Size([148, 2])
[2025-11-16 21:52:32] DEBUG -   target_bboxes: torch.Size([148, 4])
[2025-11-16 21:52:32] DEBUG -   target_cls: torch.Size([148, 2])
[2025-11-16 21:52:32] DEBUG -   proposal_features: torch.Size([148, 512])
[2025-11-16 21:52:32] DEBUG -   proposal_labels: torch.Size([148])
[2025-11-16 21:52:32] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:32] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:32] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:32] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:32] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:32] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:32] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:32] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:34] DEBUG - 
Model Outputs:
[2025-11-16 21:52:34] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:34] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:34] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2455, 1.7295]
[2025-11-16 21:52:34] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0245, 0.2866]
[2025-11-16 21:52:34] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:34] DEBUG -   pred_bboxes: torch.Size([470, 4])
[2025-11-16 21:52:34] DEBUG -   pred_cls_logits: torch.Size([470, 2])
[2025-11-16 21:52:34] DEBUG -   target_bboxes: torch.Size([470, 4])
[2025-11-16 21:52:34] DEBUG -   target_cls: torch.Size([470, 2])
[2025-11-16 21:52:34] DEBUG -   proposal_features: torch.Size([470, 512])
[2025-11-16 21:52:34] DEBUG -   proposal_labels: torch.Size([470])
[2025-11-16 21:52:34] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:34] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:34] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:34] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:34] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:34] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:34] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:34] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:36] DEBUG - 
Model Outputs:
[2025-11-16 21:52:36] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:36] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:36] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2505, 1.8105]
[2025-11-16 21:52:36] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0236, 0.3522]
[2025-11-16 21:52:36] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:36] DEBUG -   pred_bboxes: torch.Size([726, 4])
[2025-11-16 21:52:36] DEBUG -   pred_cls_logits: torch.Size([726, 2])
[2025-11-16 21:52:36] DEBUG -   target_bboxes: torch.Size([726, 4])
[2025-11-16 21:52:36] DEBUG -   target_cls: torch.Size([726, 2])
[2025-11-16 21:52:36] DEBUG -   proposal_features: torch.Size([726, 512])
[2025-11-16 21:52:36] DEBUG -   proposal_labels: torch.Size([726])
[2025-11-16 21:52:36] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:36] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:36] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:36] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:36] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:37] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:37] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:37] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:38] DEBUG - 
Model Outputs:
[2025-11-16 21:52:38] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:38] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:39] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2520, 1.7666]
[2025-11-16 21:52:39] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0241, 0.2657]
[2025-11-16 21:52:39] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:39] DEBUG -   pred_bboxes: torch.Size([333, 4])
[2025-11-16 21:52:39] DEBUG -   pred_cls_logits: torch.Size([333, 2])
[2025-11-16 21:52:39] DEBUG -   target_bboxes: torch.Size([333, 4])
[2025-11-16 21:52:39] DEBUG -   target_cls: torch.Size([333, 2])
[2025-11-16 21:52:39] DEBUG -   proposal_features: torch.Size([333, 512])
[2025-11-16 21:52:39] DEBUG -   proposal_labels: torch.Size([333])
[2025-11-16 21:52:39] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:39] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:39] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:39] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:39] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:39] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:39] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:39] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:41] DEBUG - 
Model Outputs:
[2025-11-16 21:52:41] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:41] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:41] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2517, 1.8213]
[2025-11-16 21:52:41] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0246, 0.3283]
[2025-11-16 21:52:41] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:41] DEBUG -   pred_bboxes: torch.Size([842, 4])
[2025-11-16 21:52:41] DEBUG -   pred_cls_logits: torch.Size([842, 2])
[2025-11-16 21:52:41] DEBUG -   target_bboxes: torch.Size([842, 4])
[2025-11-16 21:52:41] DEBUG -   target_cls: torch.Size([842, 2])
[2025-11-16 21:52:41] DEBUG -   proposal_features: torch.Size([842, 512])
[2025-11-16 21:52:41] DEBUG -   proposal_labels: torch.Size([842])
[2025-11-16 21:52:41] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:41] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:41] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:41] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:41] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:42] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:42] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:42] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:43] DEBUG - 
Model Outputs:
[2025-11-16 21:52:43] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:43] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:44] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2440, 1.7646]
[2025-11-16 21:52:44] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0247, 0.3215]
[2025-11-16 21:52:44] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:44] DEBUG -   pred_bboxes: torch.Size([624, 4])
[2025-11-16 21:52:44] DEBUG -   pred_cls_logits: torch.Size([624, 2])
[2025-11-16 21:52:44] DEBUG -   target_bboxes: torch.Size([624, 4])
[2025-11-16 21:52:44] DEBUG -   target_cls: torch.Size([624, 2])
[2025-11-16 21:52:44] DEBUG -   proposal_features: torch.Size([624, 512])
[2025-11-16 21:52:44] DEBUG -   proposal_labels: torch.Size([624])
[2025-11-16 21:52:44] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:44] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:44] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:44] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:44] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:44] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:44] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:44] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:45] DEBUG - 
Model Outputs:
[2025-11-16 21:52:45] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:45] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:46] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2529, 1.7744]
[2025-11-16 21:52:46] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0241, 0.2972]
[2025-11-16 21:52:46] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:46] DEBUG -   pred_bboxes: torch.Size([568, 4])
[2025-11-16 21:52:46] DEBUG -   pred_cls_logits: torch.Size([568, 2])
[2025-11-16 21:52:46] DEBUG -   target_bboxes: torch.Size([568, 4])
[2025-11-16 21:52:46] DEBUG -   target_cls: torch.Size([568, 2])
[2025-11-16 21:52:46] DEBUG -   proposal_features: torch.Size([568, 512])
[2025-11-16 21:52:46] DEBUG -   proposal_labels: torch.Size([568])
[2025-11-16 21:52:46] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:46] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:46] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:46] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:46] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:47] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:47] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:47] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:48] DEBUG - 
Model Outputs:
[2025-11-16 21:52:48] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:48] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:48] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2457, 1.8828]
[2025-11-16 21:52:48] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0238, 0.3291]
[2025-11-16 21:52:49] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:49] DEBUG -   pred_bboxes: torch.Size([491, 4])
[2025-11-16 21:52:49] DEBUG -   pred_cls_logits: torch.Size([491, 2])
[2025-11-16 21:52:49] DEBUG -   target_bboxes: torch.Size([491, 4])
[2025-11-16 21:52:49] DEBUG -   target_cls: torch.Size([491, 2])
[2025-11-16 21:52:49] DEBUG -   proposal_features: torch.Size([491, 512])
[2025-11-16 21:52:49] DEBUG -   proposal_labels: torch.Size([491])
[2025-11-16 21:52:49] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:49] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:49] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:49] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:49] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:49] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:49] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:49] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:51] DEBUG - 
Model Outputs:
[2025-11-16 21:52:51] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:51] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:51] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2559, 1.7803]
[2025-11-16 21:52:51] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0247, 0.3273]
[2025-11-16 21:52:51] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:51] DEBUG -   pred_bboxes: torch.Size([155, 4])
[2025-11-16 21:52:51] DEBUG -   pred_cls_logits: torch.Size([155, 2])
[2025-11-16 21:52:51] DEBUG -   target_bboxes: torch.Size([155, 4])
[2025-11-16 21:52:51] DEBUG -   target_cls: torch.Size([155, 2])
[2025-11-16 21:52:51] DEBUG -   proposal_features: torch.Size([155, 512])
[2025-11-16 21:52:51] DEBUG -   proposal_labels: torch.Size([155])
[2025-11-16 21:52:51] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:51] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:51] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:51] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:51] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:51] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:51] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:51] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:53] DEBUG - 
Model Outputs:
[2025-11-16 21:52:53] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:53] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:53] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2433, 1.7842]
[2025-11-16 21:52:53] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0235, 0.3283]
[2025-11-16 21:52:53] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:53] DEBUG -   pred_bboxes: torch.Size([650, 4])
[2025-11-16 21:52:53] DEBUG -   pred_cls_logits: torch.Size([650, 2])
[2025-11-16 21:52:53] DEBUG -   target_bboxes: torch.Size([650, 4])
[2025-11-16 21:52:53] DEBUG -   target_cls: torch.Size([650, 2])
[2025-11-16 21:52:53] DEBUG -   proposal_features: torch.Size([650, 512])
[2025-11-16 21:52:53] DEBUG -   proposal_labels: torch.Size([650])
[2025-11-16 21:52:53] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:53] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:53] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:53] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:53] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:53] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:53] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:53] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:55] DEBUG - 
Model Outputs:
[2025-11-16 21:52:55] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:55] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:55] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2639, 1.7852]
[2025-11-16 21:52:55] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0246, 0.2774]
[2025-11-16 21:52:55] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:55] DEBUG -   pred_bboxes: torch.Size([242, 4])
[2025-11-16 21:52:55] DEBUG -   pred_cls_logits: torch.Size([242, 2])
[2025-11-16 21:52:55] DEBUG -   target_bboxes: torch.Size([242, 4])
[2025-11-16 21:52:55] DEBUG -   target_cls: torch.Size([242, 2])
[2025-11-16 21:52:55] DEBUG -   proposal_features: torch.Size([242, 512])
[2025-11-16 21:52:55] DEBUG -   proposal_labels: torch.Size([242])
[2025-11-16 21:52:55] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:55] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:55] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:55] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:55] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:55] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:55] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:55] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:57] DEBUG - 
Model Outputs:
[2025-11-16 21:52:57] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:57] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:57] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2502, 1.8047]
[2025-11-16 21:52:57] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0242, 0.2984]
[2025-11-16 21:52:57] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:57] DEBUG -   pred_bboxes: torch.Size([325, 4])
[2025-11-16 21:52:57] DEBUG -   pred_cls_logits: torch.Size([325, 2])
[2025-11-16 21:52:57] DEBUG -   target_bboxes: torch.Size([325, 4])
[2025-11-16 21:52:57] DEBUG -   target_cls: torch.Size([325, 2])
[2025-11-16 21:52:57] DEBUG -   proposal_features: torch.Size([325, 512])
[2025-11-16 21:52:57] DEBUG -   proposal_labels: torch.Size([325])
[2025-11-16 21:52:57] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:57] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:57] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:57] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:57] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:57] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:57] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:57] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 22:12:34] DEBUG - 
Initial learning rate: 1.000000e-05
[2025-11-16 22:12:34] DEBUG - Optimizer: AdamW
[2025-11-16 22:12:34] DEBUG - Scheduler: CosineAnnealingLR
[2025-11-16 22:12:38] DEBUG - 
======================================================================
[2025-11-16 22:12:38] DEBUG - BATCH 0 - Type: detection
[2025-11-16 22:12:38] DEBUG - ======================================================================
[2025-11-16 22:12:38] DEBUG - 
Batch Contents:
[2025-11-16 22:12:38] DEBUG -   query_images:
[2025-11-16 22:12:38] DEBUG -     Shape: torch.Size([8, 3, 640, 640])
[2025-11-16 22:12:38] DEBUG -     Dtype: torch.float32
[2025-11-16 22:12:38] DEBUG -     Device: cuda:0
[2025-11-16 22:12:38] DEBUG -     Range: [-2.1179, 2.6400]
[2025-11-16 22:12:38] DEBUG -     Mean: -0.6702
[2025-11-16 22:12:38] DEBUG -     Std: 0.9102
[2025-11-16 22:12:38] DEBUG -     Has NaN: False
[2025-11-16 22:12:38] DEBUG -     Has Inf: False
[2025-11-16 22:12:38] DEBUG -   support_images:
[2025-11-16 22:12:38] DEBUG -     Shape: torch.Size([2, 3, 3, 512, 512])
[2025-11-16 22:12:38] DEBUG -     Dtype: torch.float32
[2025-11-16 22:12:38] DEBUG -     Device: cuda:0
[2025-11-16 22:12:38] DEBUG -     Range: [-2.1179, 2.6400]
[2025-11-16 22:12:38] DEBUG -     Mean: -0.5685
[2025-11-16 22:12:38] DEBUG -     Std: 1.2452
[2025-11-16 22:12:38] DEBUG -     Has NaN: False
[2025-11-16 22:12:38] DEBUG -     Has Inf: False
[2025-11-16 22:12:38] DEBUG -   target_bboxes: List of 8 tensors
[2025-11-16 22:12:38] DEBUG -     First tensor shape: torch.Size([1, 4])
[2025-11-16 22:12:38] DEBUG -   target_classes: List of 8 tensors
[2025-11-16 22:12:38] DEBUG -     First tensor shape: torch.Size([1])
[2025-11-16 22:12:38] DEBUG -   class_ids:
[2025-11-16 22:12:38] DEBUG -     Shape: torch.Size([8])
[2025-11-16 22:12:38] DEBUG -     Dtype: torch.int64
[2025-11-16 22:12:38] DEBUG -     Device: cuda:0
[2025-11-16 22:12:38] DEBUG -   video_ids: List of 8 str
[2025-11-16 22:12:38] DEBUG -   num_classes: int
[2025-11-16 22:12:38] DEBUG -   batch_type: str
[2025-11-16 22:12:38] DEBUG - 
Detection Forward Pass:
[2025-11-16 22:12:38] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 22:12:38] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 22:12:41] DEBUG - 
Model Outputs:
[2025-11-16 22:12:41] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 22:12:41] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 22:12:41] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2456, 1.7793]
[2025-11-16 22:12:41] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0249, 0.3781]
[2025-11-16 22:12:41] DEBUG - 
Loss Inputs:
[2025-11-16 22:12:41] DEBUG -   pred_bboxes: torch.Size([703, 4])
[2025-11-16 22:12:41] DEBUG -   pred_cls_logits: torch.Size([703, 2])
[2025-11-16 22:12:41] DEBUG -   target_bboxes: torch.Size([703, 4])
[2025-11-16 22:12:41] DEBUG -   target_cls: torch.Size([703, 2])
[2025-11-16 22:12:41] DEBUG -   proposal_features: torch.Size([703, 512])
[2025-11-16 22:12:41] DEBUG -   proposal_labels: torch.Size([703])
[2025-11-16 22:12:41] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 22:12:41] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 22:12:41] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 22:12:41] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 22:12:41] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 22:12:41] DEBUG - 
Loss Components:
[2025-11-16 22:12:41] DEBUG -   Total Loss: 6.439357
[2025-11-16 22:12:41] DEBUG -   bbox_loss: 2.447329
[2025-11-16 22:12:41] DEBUG -   cls_loss: 1.030023
[2025-11-16 22:12:41] DEBUG -   supcon_loss: 0.759088
[2025-11-16 22:12:41] DEBUG -   cpe_loss: 0.541199
[2025-11-16 22:12:41] DEBUG -   triplet_loss: 0.000000
[2025-11-16 22:12:41] INFO - 
============================================================
[2025-11-16 22:12:41] INFO - [Step 0] ANCHOR ASSIGNMENT DIAGNOSTICS
[2025-11-16 22:12:41] INFO - ============================================================
[2025-11-16 22:12:41] INFO - üìç Assigned Anchors: 703
[2025-11-16 22:12:41] INFO -    Total Available Anchors: 272000
[2025-11-16 22:12:41] INFO -    Assignment Rate: 0.26%
[2025-11-16 22:12:41] INFO - 
   Per-Scale Breakdown:
[2025-11-16 22:12:41] INFO -      Scale 0 (stride=4): 160x160 = 204800 anchors
[2025-11-16 22:12:41] INFO -      Scale 1 (stride=8): 80x80 = 51200 anchors
[2025-11-16 22:12:41] INFO -      Scale 2 (stride=16): 40x40 = 12800 anchors
[2025-11-16 22:12:41] INFO -      Scale 3 (stride=32): 20x20 = 3200 anchors
[2025-11-16 22:12:41] INFO - 
üéØ Ground Truth Objects:
[2025-11-16 22:12:41] INFO -    Total GT Boxes: 8
[2025-11-16 22:12:41] INFO -    Avg GT per Image: 1.00
[2025-11-16 22:12:41] INFO -    Anchors per GT: 87.88
[2025-11-16 22:12:41] INFO - 
üìê COORDINATE FORMAT VERIFICATION
[2025-11-16 22:12:41] INFO -    Format: xyxy (x1, y1, x2, y2)
[2025-11-16 22:12:41] INFO -    Predictions:
[2025-11-16 22:12:41] INFO -      Valid x2 > x1: 20.5%
[2025-11-16 22:12:41] INFO -      Valid y2 > y1: 49.8%
[2025-11-16 22:12:41] INFO -      Range: x=[-2.7, 1.7], y=[-1.7, 3.3]
[2025-11-16 22:12:41] INFO -    Targets:
[2025-11-16 22:12:41] INFO -      Valid x2 > x1: 100.0%
[2025-11-16 22:12:41] INFO -      Valid y2 > y1: 100.0%
[2025-11-16 22:12:41] INFO -      Range: x=[196.0, 550.0], y=[151.0, 469.0]
[2025-11-16 22:12:41] ERROR -    ‚ùå PREDICTION FORMAT ERROR: Some boxes have x2<=x1 or y2<=y1
[2025-11-16 22:12:41] ERROR -       ‚Üí Check bbox decoding logic in detection head
[2025-11-16 22:12:41] INFO - 
üìä BBOX STATISTICS
[2025-11-16 22:12:41] INFO -    IoU Distribution:
[2025-11-16 22:12:41] INFO -      Mean: 0.000
[2025-11-16 22:12:41] INFO -      Median: 0.000
[2025-11-16 22:12:41] INFO -      Min: 0.000, Max: 0.000
[2025-11-16 22:12:41] INFO -      Histogram:
[2025-11-16 22:12:41] INFO -        [0.0, 0.1):  703 (100.0%)
[2025-11-16 22:12:41] INFO -        [0.1, 0.3):    0 (  0.0%)
[2025-11-16 22:12:41] INFO -        [0.3, 0.5):    0 (  0.0%)
[2025-11-16 22:12:41] INFO -        [0.5, 0.7):    0 (  0.0%)
[2025-11-16 22:12:41] INFO -        [0.7, 0.9):    0 (  0.0%)
[2025-11-16 22:12:41] INFO -        [0.9, 1.0):    0 (  0.0%)
[2025-11-16 22:12:41] INFO - 
   Target BBox Sizes:
[2025-11-16 22:12:41] INFO -      Mean size (‚àöarea): 34.9 pixels
[2025-11-16 22:12:41] INFO -      Mean width: 39.1, height: 32.7
[2025-11-16 22:12:41] INFO -      Min: 20.6, Max: 41.4
[2025-11-16 22:12:41] INFO -      Size Distribution:
[2025-11-16 22:12:41] INFO -        Small (<32¬≤): 162 (23.0%)
[2025-11-16 22:12:41] INFO -        Medium (32¬≤-96¬≤): 541 (77.0%)
[2025-11-16 22:12:41] INFO -        Large (>96¬≤): 0 (0.0%)
[2025-11-16 22:12:41] INFO - 
   Aspect Ratios (width/height):
[2025-11-16 22:12:41] INFO -      Target mean: 1.30
[2025-11-16 22:12:41] INFO -      Pred mean: 0.91
[2025-11-16 22:12:41] INFO - 
   Anchor Statistics:
[2025-11-16 22:12:41] INFO -      Stride  4:  527 anchors, mean IoU: 0.000
[2025-11-16 22:12:41] INFO -      Stride  8:  130 anchors, mean IoU: 0.000
[2025-11-16 22:12:41] INFO -      Stride 16:   35 anchors, mean IoU: 0.000
[2025-11-16 22:12:41] INFO -      Stride 32:   11 anchors, mean IoU: 0.000
[2025-11-16 22:12:41] INFO - 
üéØ CLASSIFICATION STATISTICS
[2025-11-16 22:12:41] INFO -    Accuracy: 42.39%
[2025-11-16 22:12:41] INFO -    Confidence (max prob):
[2025-11-16 22:12:41] INFO -      Mean: 0.633
[2025-11-16 22:12:41] INFO -      Min: 0.025, Max: 0.993
[2025-11-16 22:12:41] INFO - 
   Class Distribution:
[2025-11-16 22:12:41] INFO -      Class 0: 541 samples
[2025-11-16 22:12:41] INFO -      Class 1: 162 samples
[2025-11-16 22:12:41] INFO - 
üí∞ LOSS BREAKDOWN
[2025-11-16 22:12:41] INFO -    Total Loss: 0.0000
[2025-11-16 22:12:41] INFO -      bbox_loss      :   2.4473 (  0.0%)
[2025-11-16 22:12:41] INFO -      cls_loss       :   1.0300 (  0.0%)
[2025-11-16 22:12:41] INFO -      supcon_loss    :   0.7591 (  0.0%)
[2025-11-16 22:12:41] INFO -      cpe_loss       :   0.5412 (  0.0%)
[2025-11-16 22:12:41] INFO -      triplet_loss   :   0.0000 (  0.0%)
[2025-11-16 22:12:47] DEBUG - 
Detection Forward Pass:
[2025-11-16 22:12:47] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 22:12:47] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 22:12:48] DEBUG - 
Model Outputs:
[2025-11-16 22:12:48] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 22:12:48] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 22:12:48] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2566, 1.7793]
[2025-11-16 22:12:48] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0250, 0.3444]
[2025-11-16 22:12:49] DEBUG - 
Loss Inputs:
[2025-11-16 22:12:49] DEBUG -   pred_bboxes: torch.Size([113, 4])
[2025-11-16 22:12:49] DEBUG -   pred_cls_logits: torch.Size([113, 2])
[2025-11-16 22:12:49] DEBUG -   target_bboxes: torch.Size([113, 4])
[2025-11-16 22:12:49] DEBUG -   target_cls: torch.Size([113, 2])
[2025-11-16 22:12:49] DEBUG -   proposal_features: torch.Size([113, 512])
[2025-11-16 22:12:49] DEBUG -   proposal_labels: torch.Size([113])
[2025-11-16 22:12:49] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 22:12:49] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 22:12:49] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 22:12:49] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 22:12:49] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 22:12:49] INFO - 
============================================================
[2025-11-16 22:12:49] INFO - [Step 0] ANCHOR ASSIGNMENT DIAGNOSTICS
[2025-11-16 22:12:49] INFO - ============================================================
[2025-11-16 22:12:49] INFO - üìç Assigned Anchors: 113
[2025-11-16 22:12:49] INFO -    Total Available Anchors: 272000
[2025-11-16 22:12:49] INFO -    Assignment Rate: 0.04%
[2025-11-16 22:12:49] INFO - 
   Per-Scale Breakdown:
[2025-11-16 22:12:49] INFO -      Scale 0 (stride=4): 160x160 = 204800 anchors
[2025-11-16 22:12:49] INFO -      Scale 1 (stride=8): 80x80 = 51200 anchors
[2025-11-16 22:12:49] INFO -      Scale 2 (stride=16): 40x40 = 12800 anchors
[2025-11-16 22:12:49] INFO -      Scale 3 (stride=32): 20x20 = 3200 anchors
[2025-11-16 22:12:49] INFO - 
üéØ Ground Truth Objects:
[2025-11-16 22:12:49] INFO -    Total GT Boxes: 7
[2025-11-16 22:12:49] INFO -    Avg GT per Image: 0.88
[2025-11-16 22:12:49] INFO -    Anchors per GT: 16.14
[2025-11-16 22:12:49] INFO - 
üìê COORDINATE FORMAT VERIFICATION
[2025-11-16 22:12:49] INFO -    Format: xyxy (x1, y1, x2, y2)
[2025-11-16 22:12:49] INFO -    Predictions:
[2025-11-16 22:12:49] INFO -      Valid x2 > x1: 17.7%
[2025-11-16 22:12:49] INFO -      Valid y2 > y1: 46.0%
[2025-11-16 22:12:49] INFO -      Range: x=[-0.7, 2.0], y=[-2.4, 1.8]
[2025-11-16 22:12:49] INFO -    Targets:
[2025-11-16 22:12:49] INFO -      Valid x2 > x1: 100.0%
[2025-11-16 22:12:49] INFO -      Valid y2 > y1: 100.0%
[2025-11-16 22:12:49] INFO -      Range: x=[99.4, 527.0], y=[0.6, 423.0]
[2025-11-16 22:12:49] ERROR -    ‚ùå PREDICTION FORMAT ERROR: Some boxes have x2<=x1 or y2<=y1
[2025-11-16 22:12:49] ERROR -       ‚Üí Check bbox decoding logic in detection head
[2025-11-16 22:12:49] INFO - 
üìä BBOX STATISTICS
[2025-11-16 22:12:49] INFO -    IoU Distribution:
[2025-11-16 22:12:49] INFO -      Mean: 0.000
[2025-11-16 22:12:49] INFO -      Median: 0.000
[2025-11-16 22:12:49] INFO -      Min: 0.000, Max: 0.000
[2025-11-16 22:12:49] INFO -      Histogram:
[2025-11-16 22:12:49] INFO -        [0.0, 0.1):  113 (100.0%)
[2025-11-16 22:12:49] INFO -        [0.1, 0.3):    0 (  0.0%)
[2025-11-16 22:12:49] INFO -        [0.3, 0.5):    0 (  0.0%)
[2025-11-16 22:12:49] INFO -        [0.5, 0.7):    0 (  0.0%)
[2025-11-16 22:12:49] INFO -        [0.7, 0.9):    0 (  0.0%)
[2025-11-16 22:12:49] INFO -        [0.9, 1.0):    0 (  0.0%)
[2025-11-16 22:12:49] INFO - 
   Target BBox Sizes:
[2025-11-16 22:12:49] INFO -      Mean size (‚àöarea): 13.8 pixels
[2025-11-16 22:12:49] INFO -      Mean width: 15.9, height: 12.4
[2025-11-16 22:12:49] INFO -      Min: 7.9, Max: 17.8
[2025-11-16 22:12:49] INFO -      Size Distribution:
[2025-11-16 22:12:49] INFO -        Small (<32¬≤): 113 (100.0%)
[2025-11-16 22:12:49] INFO -        Medium (32¬≤-96¬≤): 0 (0.0%)
[2025-11-16 22:12:49] INFO -        Large (>96¬≤): 0 (0.0%)
[2025-11-16 22:12:49] INFO - 
   Aspect Ratios (width/height):
[2025-11-16 22:12:49] INFO -      Target mean: 1.44
[2025-11-16 22:12:49] INFO -      Pred mean: -10.38
[2025-11-16 22:12:49] INFO - 
   Anchor Statistics:
[2025-11-16 22:12:49] INFO -      Stride  4:   80 anchors, mean IoU: 0.000
[2025-11-16 22:12:49] INFO -      Stride  8:   19 anchors, mean IoU: 0.000
[2025-11-16 22:12:49] INFO -      Stride 16:    7 anchors, mean IoU: 0.000
[2025-11-16 22:12:49] INFO -      Stride 32:    7 anchors, mean IoU: 0.000
[2025-11-16 22:12:49] INFO - 
üéØ CLASSIFICATION STATISTICS
[2025-11-16 22:12:49] INFO -    Accuracy: 40.71%
[2025-11-16 22:12:49] INFO -    Confidence (max prob):
[2025-11-16 22:12:49] INFO -      Mean: 0.608
[2025-11-16 22:12:49] INFO -      Min: 0.079, Max: 0.961
[2025-11-16 22:12:49] INFO - 
   Class Distribution:
[2025-11-16 22:12:49] INFO -      Class 0: 41 samples
[2025-11-16 22:12:49] INFO -      Class 1: 72 samples
[2025-11-16 22:12:49] INFO - 
üí∞ LOSS BREAKDOWN
[2025-11-16 22:12:49] INFO -    Total Loss: 0.0000
[2025-11-16 22:12:49] INFO -      bbox_loss      :   2.5988 (  0.0%)
[2025-11-16 22:12:49] INFO -      cls_loss       :   0.9597 (  0.0%)
[2025-11-16 22:12:49] INFO -      supcon_loss    :   0.6932 (  0.0%)
[2025-11-16 22:12:49] INFO -      cpe_loss       :   0.6641 (  0.0%)
[2025-11-16 22:12:49] INFO -      triplet_loss   :   0.0000 (  0.0%)
