[2025-11-16 21:52:05] DEBUG - 
Initial learning rate: 1.000000e-05
[2025-11-16 21:52:05] DEBUG - Optimizer: AdamW
[2025-11-16 21:52:05] DEBUG - Scheduler: CosineAnnealingLR
[2025-11-16 21:52:08] DEBUG - 
======================================================================
[2025-11-16 21:52:08] DEBUG - BATCH 0 - Type: detection
[2025-11-16 21:52:08] DEBUG - ======================================================================
[2025-11-16 21:52:08] DEBUG - 
Batch Contents:
[2025-11-16 21:52:08] DEBUG -   query_images:
[2025-11-16 21:52:08] DEBUG -     Shape: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:08] DEBUG -     Dtype: torch.float32
[2025-11-16 21:52:08] DEBUG -     Device: cuda:0
[2025-11-16 21:52:08] DEBUG -     Range: [-2.1179, 2.6400]
[2025-11-16 21:52:08] DEBUG -     Mean: -0.5034
[2025-11-16 21:52:08] DEBUG -     Std: 0.9666
[2025-11-16 21:52:08] DEBUG -     Has NaN: False
[2025-11-16 21:52:08] DEBUG -     Has Inf: False
[2025-11-16 21:52:08] DEBUG -   support_images:
[2025-11-16 21:52:08] DEBUG -     Shape: torch.Size([2, 3, 3, 512, 512])
[2025-11-16 21:52:08] DEBUG -     Dtype: torch.float32
[2025-11-16 21:52:08] DEBUG -     Device: cuda:0
[2025-11-16 21:52:08] DEBUG -     Range: [-2.1179, 2.6400]
[2025-11-16 21:52:08] DEBUG -     Mean: 0.3177
[2025-11-16 21:52:08] DEBUG -     Std: 1.0175
[2025-11-16 21:52:08] DEBUG -     Has NaN: False
[2025-11-16 21:52:08] DEBUG -     Has Inf: False
[2025-11-16 21:52:08] DEBUG -   target_bboxes: List of 8 tensors
[2025-11-16 21:52:08] DEBUG -     First tensor shape: torch.Size([1, 4])
[2025-11-16 21:52:08] DEBUG -   target_classes: List of 8 tensors
[2025-11-16 21:52:08] DEBUG -     First tensor shape: torch.Size([1])
[2025-11-16 21:52:08] DEBUG -   class_ids:
[2025-11-16 21:52:08] DEBUG -     Shape: torch.Size([8])
[2025-11-16 21:52:08] DEBUG -     Dtype: torch.int64
[2025-11-16 21:52:08] DEBUG -     Device: cuda:0
[2025-11-16 21:52:08] DEBUG -   video_ids: List of 8 str
[2025-11-16 21:52:08] DEBUG -   num_classes: int
[2025-11-16 21:52:08] DEBUG -   batch_type: str
[2025-11-16 21:52:08] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:08] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:08] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:11] DEBUG - 
Model Outputs:
[2025-11-16 21:52:11] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:11] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:11] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2512, 1.7871]
[2025-11-16 21:52:11] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0248, 0.3237]
[2025-11-16 21:52:11] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:11] DEBUG -   pred_bboxes: torch.Size([273, 4])
[2025-11-16 21:52:11] DEBUG -   pred_cls_logits: torch.Size([273, 2])
[2025-11-16 21:52:11] DEBUG -   target_bboxes: torch.Size([273, 4])
[2025-11-16 21:52:11] DEBUG -   target_cls: torch.Size([273, 2])
[2025-11-16 21:52:11] DEBUG -   proposal_features: torch.Size([273, 512])
[2025-11-16 21:52:11] DEBUG -   proposal_labels: torch.Size([273])
[2025-11-16 21:52:11] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:11] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:11] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:11] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:11] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:12] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:12] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:12] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:13] DEBUG - 
Model Outputs:
[2025-11-16 21:52:13] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:13] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:14] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2544, 1.7881]
[2025-11-16 21:52:14] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0246, 0.3635]
[2025-11-16 21:52:14] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:14] DEBUG -   pred_bboxes: torch.Size([427, 4])
[2025-11-16 21:52:14] DEBUG -   pred_cls_logits: torch.Size([427, 2])
[2025-11-16 21:52:14] DEBUG -   target_bboxes: torch.Size([427, 4])
[2025-11-16 21:52:14] DEBUG -   target_cls: torch.Size([427, 2])
[2025-11-16 21:52:14] DEBUG -   proposal_features: torch.Size([427, 512])
[2025-11-16 21:52:14] DEBUG -   proposal_labels: torch.Size([427])
[2025-11-16 21:52:14] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:14] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:14] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:14] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:14] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:14] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:14] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:14] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:15] DEBUG - 
Model Outputs:
[2025-11-16 21:52:15] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:15] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:16] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2537, 1.7461]
[2025-11-16 21:52:16] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0241, 0.3504]
[2025-11-16 21:52:16] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:16] DEBUG -   pred_bboxes: torch.Size([151, 4])
[2025-11-16 21:52:16] DEBUG -   pred_cls_logits: torch.Size([151, 2])
[2025-11-16 21:52:16] DEBUG -   target_bboxes: torch.Size([151, 4])
[2025-11-16 21:52:16] DEBUG -   target_cls: torch.Size([151, 2])
[2025-11-16 21:52:16] DEBUG -   proposal_features: torch.Size([151, 512])
[2025-11-16 21:52:16] DEBUG -   proposal_labels: torch.Size([151])
[2025-11-16 21:52:16] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:16] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:16] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:16] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:16] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:16] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:16] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:16] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:17] DEBUG - 
Model Outputs:
[2025-11-16 21:52:17] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:17] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:18] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2573, 1.7627]
[2025-11-16 21:52:18] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0246, 0.3514]
[2025-11-16 21:52:18] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:18] DEBUG -   pred_bboxes: torch.Size([388, 4])
[2025-11-16 21:52:18] DEBUG -   pred_cls_logits: torch.Size([388, 2])
[2025-11-16 21:52:18] DEBUG -   target_bboxes: torch.Size([388, 4])
[2025-11-16 21:52:18] DEBUG -   target_cls: torch.Size([388, 2])
[2025-11-16 21:52:18] DEBUG -   proposal_features: torch.Size([388, 512])
[2025-11-16 21:52:18] DEBUG -   proposal_labels: torch.Size([388])
[2025-11-16 21:52:18] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:18] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:18] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:18] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:18] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:18] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:18] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:18] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:19] DEBUG - 
Model Outputs:
[2025-11-16 21:52:19] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:19] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:20] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2491, 1.7666]
[2025-11-16 21:52:20] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0250, 0.2757]
[2025-11-16 21:52:20] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:20] DEBUG -   pred_bboxes: torch.Size([565, 4])
[2025-11-16 21:52:20] DEBUG -   pred_cls_logits: torch.Size([565, 2])
[2025-11-16 21:52:20] DEBUG -   target_bboxes: torch.Size([565, 4])
[2025-11-16 21:52:20] DEBUG -   target_cls: torch.Size([565, 2])
[2025-11-16 21:52:20] DEBUG -   proposal_features: torch.Size([565, 512])
[2025-11-16 21:52:20] DEBUG -   proposal_labels: torch.Size([565])
[2025-11-16 21:52:20] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:20] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:20] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:20] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:20] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:20] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:20] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:20] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:22] DEBUG - 
Model Outputs:
[2025-11-16 21:52:22] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:22] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:22] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2478, 1.7646]
[2025-11-16 21:52:22] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0247, 0.2991]
[2025-11-16 21:52:22] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:22] DEBUG -   pred_bboxes: torch.Size([466, 4])
[2025-11-16 21:52:22] DEBUG -   pred_cls_logits: torch.Size([466, 2])
[2025-11-16 21:52:22] DEBUG -   target_bboxes: torch.Size([466, 4])
[2025-11-16 21:52:22] DEBUG -   target_cls: torch.Size([466, 2])
[2025-11-16 21:52:22] DEBUG -   proposal_features: torch.Size([466, 512])
[2025-11-16 21:52:22] DEBUG -   proposal_labels: torch.Size([466])
[2025-11-16 21:52:22] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:22] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:22] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:22] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:22] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:22] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:22] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:22] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
[2025-11-16 21:52:23] DEBUG - 
Model Outputs:
[2025-11-16 21:52:23] DEBUG -   prototype_boxes: List of 4 tensors, first shape=torch.Size([8, 4, 160, 160])
[2025-11-16 21:52:23] DEBUG -   prototype_sim: List of 4 tensors, first shape=torch.Size([8, 2, 160, 160])
[2025-11-16 21:52:24] DEBUG -   query_features: torch.Size([8, 128]), range=[-0.2593, 1.7529]
[2025-11-16 21:52:24] DEBUG -   support_prototypes: torch.Size([2, 128]), range=[-0.0247, 0.2777]
[2025-11-16 21:52:24] DEBUG - 
Loss Inputs:
[2025-11-16 21:52:24] DEBUG -   pred_bboxes: torch.Size([583, 4])
[2025-11-16 21:52:24] DEBUG -   pred_cls_logits: torch.Size([583, 2])
[2025-11-16 21:52:24] DEBUG -   target_bboxes: torch.Size([583, 4])
[2025-11-16 21:52:24] DEBUG -   target_cls: torch.Size([583, 2])
[2025-11-16 21:52:24] DEBUG -   proposal_features: torch.Size([583, 512])
[2025-11-16 21:52:24] DEBUG -   proposal_labels: torch.Size([583])
[2025-11-16 21:52:24] DEBUG -   query_features: torch.Size([8, 128])
[2025-11-16 21:52:24] DEBUG -   support_prototypes: torch.Size([2, 128])
[2025-11-16 21:52:24] DEBUG -   feature_labels: torch.Size([8])
[2025-11-16 21:52:24] DEBUG -   triplet_embeddings: torch.Size([8, 128])
[2025-11-16 21:52:24] DEBUG -   triplet_labels: torch.Size([8])
[2025-11-16 21:52:24] DEBUG - 
Detection Forward Pass:
[2025-11-16 21:52:24] DEBUG -   Support images: N=2, K=3, C=3, H=512, W=512
[2025-11-16 21:52:24] DEBUG -   Query images: torch.Size([8, 3, 640, 640])
